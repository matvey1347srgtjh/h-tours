

## Сценарий #1: Создание опроса и вариантов ответа

**Цель:** Проверить, что опрос создаётся с указанным вопросом, автором и двумя вариантами ответа.

- **Предпосылки:** В базе данных создан тестовый пользователь.
- **Шаги:**
  1. Создать опрос с вопросом «Тестовый вопрос?» и привязкой к пользователю.
  2. Добавить к опросу два варианта ответа («Вариант 1», «Вариант 2»).
  3. Проверить атрибуты опроса и количество вариантов.
- **Ожидаемый результат:** Вопрос совпадает с заданным, `created_by` равен пользователю, у опроса ровно 2 варианта ответа.

---

## Сценарий #2: Подсчёт результатов голосования

**Цель:** Убедиться, что сумма голосов по всем вариантам совпадает с общим количеством голосов по опросу.

- **Предпосылки:** В базе созданы пользователи и опрос с двумя вариантами (A и B).
- **Шаги:**
  1. Записать голос первого пользователя за вариант A.
  2. Записать голос второго пользователя за вариант B.
  3. Получить общее число голосов по опросу через `get_total_votes()`.
  4. Суммировать голоса по каждому варианту через `get_votes_count()`.
- **Ожидаемый результат:** Общее число голосов равно 2, сумма голосов по вариантам тоже равна 2.

---

## Сценарий #3: Создание опроса доступно только авторизованным

**Цель:** Проверить, что неавторизованный пользователь не может открыть страницу создания опроса.

- **Предпосылки:** В базе создан пользователь, клиент был авторизован под ним.
- **Шаги:**
  1. Выполнить выход из учётной записи.
  2. Выполнить GET-запрос к URL страницы создания опроса (`/create/`).
- **Ожидаемый результат:** Ответ имеет код 302, в URL редиректа присутствует «login».

---

## Сценарий #4: POST на создание опроса создаёт опрос и редиректит на список

**Цель:** Проверить, что отправка формы создания опроса создаёт запись в БД и перенаправляет на главную.

- **Предпосылки:** Пользователь авторизован.
- **Шаги:**
  1. Отправить POST-запрос на URL создания опроса с полями: вопрос «Опрос с формы», три варианта «Один», «Два», «Три».
  2. Проверить код ответа и URL редиректа.
  3. Проверить количество опросов в БД и данные созданного опроса.
- **Ожидаемый результат:** Код ответа 302, редирект на список опросов; в БД ровно один опрос с вопросом «Опрос с формы» и тремя вариантами ответа.

---

## Сценарий #5: На главной показывается форма голосования, если пользователь не голосовал

**Цель:** Убедиться, что для опроса, в котором пользователь ещё не голосовал, на главной отображается форма выбора варианта.

- **Предпосылки:** В базе созданы пользователь и опрос с вариантами «Да» и «Нет», голосов по опросу нет.
- **Шаги:**
  1. Выполнить GET-запрос к главной странице (список опросов).
  2. Найти в контексте данные по тестовому опросу в `poll_list_data`.
  3. Проверить флаг `voted` и наличие формы в данных элемента.
- **Ожидаемый результат:** Код ответа 200; для опроса `voted` равен `False`, в элементе есть ключ `form`, значение — экземпляр `VoteForm`.

---

## Сценарий #6: Отправка голоса с главной — редирект на главную, голос учтён

**Цель:** Проверить, что после отправки голоса через форму на главной происходит редирект на главную и голос сохраняется.

- **Предпосылки:** В базе созданы пользователь и опрос с вариантами «Да» и «Нет».
- **Шаги:**
  1. Отправить POST-запрос на URL отправки голоса (`/vote/<id>/`) с выбранным вариантом.
  2. Проверить код ответа и URL редиректа.
  3. Проверить общее количество голосов по опросу.
- **Ожидаемый результат:** Код ответа 302, редирект на главную; у опроса ровно 1 голос.

---

## Фактический результат

```
Ran 6 tests in 3.636s. OK
```
